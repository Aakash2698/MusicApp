{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/akashsuryavanshi/Dropbox/My Mac (Akashs-iMac.local)/Documents/Tunex Workspace/Git Repo/MusicApp/src/Components/ReusableComponents/Dropzone/Dropzone.jsx\";\nimport React, { Component } from \"react\";\nimport DropzoneComponent from \"react-dropzone-component\";\nimport \"../../../../node_modules/react-dropzone-component/styles/filepicker.css\";\nimport \"../../../../node_modules/dropzone/dist/min/dropzone.min.css\"; // import \"../../../../dropzone/dist/min/dropzone.min.css\";\n\nimport randomstring from \"randomstring\";\nimport MyCropper from \"../image-cropper.jsx\";\nimport Modal from \"../Modal\";\nimport \"./dropzone.scss\";\nimport defaultUserImage from \"../../../Assets/default.jpg\";\n\nclass Dropzone extends Component {\n  constructor(...args) {\n    super(...args);\n    this.myDropzone = null;\n    this.state = {\n      isEdit: null,\n      originalFile: \"\",\n      fileName: \"\",\n      newFile: \"\",\n      showModal: false,\n      preview: \"\",\n      lastImage: \"\"\n    };\n\n    this.initCallback = dropzone => {\n      console.log(\"initCallback\");\n      this.myDropzone = dropzone;\n    };\n\n    this.removeFileFromDropzone = file => {\n      console.log(\"removeFileFromDropzone\");\n\n      if (this.myDropzone) {\n        this.myDropzone.removeAllFiles();\n      }\n    };\n\n    this.renameFile = (file, key) => {\n      console.log(\"renameFile\"); // const newFile = new File([file], randomstring.generate(12) + \".\" + this.state.fileName.split(\".\")[1], { type: file.type });\n\n      const newFile = new File([file], randomstring.generate(6) + (key ? \"_\" + key : \"\") + \".\" + file.type.split(\"/\")[1], {\n        type: file.type\n      });\n      return newFile;\n    };\n\n    this.handleCroppedImage = cropData => {\n      console.log(\"handleCroppedImage\");\n\n      if (cropData) {\n        this.removeFileFromDropzone(\"\");\n        this.setState({\n          preview: cropData.preview,\n          showModal: false\n        }, () => {\n          var byteString = atob(cropData.preview.split(\",\")[1]);\n          var mimeString = cropData.preview.split(\",\")[0].split(\":\")[1].split(\";\")[0];\n          var ab = new ArrayBuffer(byteString.length);\n          var ia = new Uint8Array(ab);\n\n          for (var i = 0; i < byteString.length; i++) {\n            ia[i] = byteString.charCodeAt(i);\n          }\n\n          var file = new File([ia], this.state.fileName, {\n            type: mimeString\n          });\n          this.setState({\n            newFile: cropData.preview\n          });\n          this.props.addFile(file, this.props.id);\n        });\n      }\n    };\n\n    this.openModal = () => {\n      console.log(\"openModal\");\n      this.setState({\n        showModal: true\n      });\n    };\n\n    this.hideModal = () => {\n      console.log(\"hideModal\");\n      this.setState({\n        showModal: false\n      });\n    };\n\n    this.removePreview = () => {\n      console.log(\"removePreview\");\n      this.props.removeFile(this.props.id);\n      this.setState({\n        preview: null\n      });\n    };\n\n    this.toggleModal = () => {\n      console.log(\"toggleModal\");\n\n      if (!this.state.isLoading) {\n        if (this.state.showModal) {\n          this.removeFileFromDropzone(\"\");\n          this.setState({\n            showModal: !this.state.showModal,\n            preview: this.state.lastImage // preview: this.state.originalFile,\n\n          });\n          return;\n        }\n\n        this.setState({\n          showModal: !this.state.showModal\n        });\n      }\n    };\n  }\n\n  componentWillMount() {\n    console.log(\"componentWillMount\");\n    this.props.onRef(this);\n    let {\n      isEdit,\n      imageUrl\n    } = this.props;\n\n    if (isEdit) {\n      this.setState({\n        isEdit: isEdit,\n        preview: imageUrl,\n        originalFile: imageUrl,\n        lastImage: imageUrl\n      });\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    console.log(\"componentWillReceiveProps\");\n\n    if (this.props.preview !== null && typeof nextProps.imageUrl === \"string\") {\n      let {\n        isEdit,\n        imageUrl\n      } = nextProps;\n\n      if (isEdit) {\n        this.setState({\n          isEdit: isEdit,\n          preview: imageUrl,\n          originalFile: imageUrl,\n          lastImage: imageUrl\n        });\n      }\n    }\n  }\n\n  handleDroppedFile(file) {\n    console.log(\"handleDroppedFile\");\n    console.log(file);\n    var reader = new FileReader();\n    let that = this;\n    reader.addEventListener(\"load\", function () {\n      that.setState({\n        originalFile: reader.result,\n        fileName: file.name,\n        showModal: true\n      });\n    }, false);\n\n    if (file) {\n      reader.readAsDataURL(file);\n    }\n  }\n\n  render() {\n    console.log(showModal, this.state.preview);\n    let {\n      originalFile,\n      newFile,\n      showModal\n    } = this.state;\n    var componentConfig = {\n      iconFiletypes: [\".jpg\", \".png\"],\n      showFiletypeIcon: true,\n      postUrl: \"no-url\"\n    };\n    let djsConfig = {\n      autoProcesQueue: false,\n      maxFiles: 1,\n      acceptedFiles: \"image/*\"\n    };\n    var eventHandlers = {\n      init: this.initCallback,\n      addedfile: file => this.handleDroppedFile(file)\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      children: [this.state.preview ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-6 el-element-overlay\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"el-card-item\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"el-card-avatar el-overlay-1\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: this.state.preview,\n              alt: \"no preview\",\n              onError: e => {\n                e.target.onerror = null;\n                e.target.src = defaultUserImage;\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"el-overlay scrl-dwn\",\n              children: /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"el-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                  children: /*#__PURE__*/_jsxDEV(\"button\", {\n                    type: \"button\",\n                    className: \"btn-outline btn-danger btn-xs image-popup-vertical-fit p-2 p-l-10 p-r-10\",\n                    onClick: () => this.openModal(),\n                    children: /*#__PURE__*/_jsxDEV(\"i\", {\n                      className: \"fa fa-edit statusIcon\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 212,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 207,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 206,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: /*#__PURE__*/_jsxDEV(\"button\", {\n                    type: \"button\",\n                    className: \"btn-outline btn-danger btn-xs image-popup-vertical-fit p-2 p-l-10 p-r-10\",\n                    onClick: () => this.removePreview(),\n                    children: /*#__PURE__*/_jsxDEV(\"i\", {\n                      className: \"fa fa-times statusIcon\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 221,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 216,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 215,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 205,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-12\",\n        children: /*#__PURE__*/_jsxDEV(DropzoneComponent, {\n          config: componentConfig,\n          eventHandlers: eventHandlers,\n          djsConfig: djsConfig\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 11\n      }, this), showModal && /*#__PURE__*/_jsxDEV(Modal, {\n        toggleModal: this.toggleModal,\n        modalfrom: \"dropZone\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-20\",\n            children: /*#__PURE__*/_jsxDEV(MyCropper, {\n              originalUploadFile: originalFile,\n              handleCroppImage: this.handleCroppedImage,\n              newFile: newFile\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default Dropzone;","map":{"version":3,"sources":["/Users/akashsuryavanshi/Dropbox/My Mac (Akashs-iMac.local)/Documents/Tunex Workspace/Git Repo/MusicApp/src/Components/ReusableComponents/Dropzone/Dropzone.jsx"],"names":["React","Component","DropzoneComponent","randomstring","MyCropper","Modal","defaultUserImage","Dropzone","myDropzone","state","isEdit","originalFile","fileName","newFile","showModal","preview","lastImage","initCallback","dropzone","console","log","removeFileFromDropzone","file","removeAllFiles","renameFile","key","File","generate","type","split","handleCroppedImage","cropData","setState","byteString","atob","mimeString","ab","ArrayBuffer","length","ia","Uint8Array","i","charCodeAt","props","addFile","id","openModal","hideModal","removePreview","removeFile","toggleModal","isLoading","componentWillMount","onRef","imageUrl","componentWillReceiveProps","nextProps","handleDroppedFile","reader","FileReader","that","addEventListener","result","name","readAsDataURL","render","componentConfig","iconFiletypes","showFiletypeIcon","postUrl","djsConfig","autoProcesQueue","maxFiles","acceptedFiles","eventHandlers","init","addedfile","e","target","onerror","src"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport DropzoneComponent from \"react-dropzone-component\";\nimport \"../../../../node_modules/react-dropzone-component/styles/filepicker.css\";\nimport \"../../../../node_modules/dropzone/dist/min/dropzone.min.css\";\n// import \"../../../../dropzone/dist/min/dropzone.min.css\";\nimport randomstring from \"randomstring\";\nimport MyCropper from \"../image-cropper.jsx\";\nimport Modal from \"../Modal\";\nimport \"./dropzone.scss\";\nimport defaultUserImage from \"../../../Assets/default.jpg\";\n\nclass Dropzone extends Component {\n  myDropzone = null;\n  state = {\n    isEdit: null,\n    originalFile: \"\",\n    fileName: \"\",\n    newFile: \"\",\n    showModal: false,\n    preview: \"\",\n    lastImage: \"\",\n  };\n\n  componentWillMount() {\n    console.log(\"componentWillMount\");\n    this.props.onRef(this);\n    let { isEdit, imageUrl } = this.props;\n\n    if (isEdit) {\n      this.setState({\n        isEdit: isEdit,\n        preview: imageUrl,\n        originalFile: imageUrl,\n        lastImage: imageUrl,\n      });\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    console.log(\"componentWillReceiveProps\");\n    if (this.props.preview !== null && typeof nextProps.imageUrl === \"string\") {\n      let { isEdit, imageUrl } = nextProps;\n      if (isEdit) {\n        this.setState({\n          isEdit: isEdit,\n          preview: imageUrl,\n          originalFile: imageUrl,\n          lastImage: imageUrl,\n        });\n      }\n    }\n  }\n\n  initCallback = (dropzone) => {\n    console.log(\"initCallback\");\n    this.myDropzone = dropzone;\n  };\n\n  removeFileFromDropzone = (file) => {\n    console.log(\"removeFileFromDropzone\");\n    if (this.myDropzone) {\n      this.myDropzone.removeAllFiles();\n    }\n  };\n\n  renameFile = (file, key) => {\n    console.log(\"renameFile\");\n    // const newFile = new File([file], randomstring.generate(12) + \".\" + this.state.fileName.split(\".\")[1], { type: file.type });\n    const newFile = new File(\n      [file],\n      randomstring.generate(6) +\n        (key ? \"_\" + key : \"\") +\n        \".\" +\n        file.type.split(\"/\")[1],\n      { type: file.type }\n    );\n    return newFile;\n  };\n\n  handleDroppedFile(file) {\n    console.log(\"handleDroppedFile\");\n    console.log(file);\n    var reader = new FileReader();\n    let that = this;\n    reader.addEventListener(\n      \"load\",\n      function () {\n        that.setState({\n          originalFile: reader.result,\n          fileName: file.name,\n          showModal: true,\n        });\n      },\n      false\n    );\n    if (file) {\n      reader.readAsDataURL(file);\n    }\n  }\n\n  handleCroppedImage = (cropData) => {\n    console.log(\"handleCroppedImage\");\n    if (cropData) {\n      this.removeFileFromDropzone(\"\");\n      this.setState(\n        {\n          preview: cropData.preview,\n          showModal: false,\n        },\n        () => {\n          var byteString = atob(cropData.preview.split(\",\")[1]);\n          var mimeString = cropData.preview\n            .split(\",\")[0]\n            .split(\":\")[1]\n            .split(\";\")[0];\n          var ab = new ArrayBuffer(byteString.length);\n          var ia = new Uint8Array(ab);\n          for (var i = 0; i < byteString.length; i++) {\n            ia[i] = byteString.charCodeAt(i);\n          }\n          var file = new File([ia], this.state.fileName, { type: mimeString });\n          this.setState({\n            newFile: cropData.preview,\n          });\n          this.props.addFile(file, this.props.id);\n        }\n      );\n    }\n  };\n\n  openModal = () => {\n    console.log(\"openModal\");\n    this.setState({\n      showModal: true,\n    });\n  };\n\n  hideModal = () => {\n    console.log(\"hideModal\");\n    this.setState({\n      showModal: false,\n    });\n  };\n\n  removePreview = () => {\n    console.log(\"removePreview\");\n    this.props.removeFile(this.props.id);\n    this.setState({\n      preview: null,\n    });\n  };\n\n  toggleModal = () => {\n    console.log(\"toggleModal\");\n    if (!this.state.isLoading) {\n      if (this.state.showModal) {\n        this.removeFileFromDropzone(\"\");\n        this.setState({\n          showModal: !this.state.showModal,\n          preview: this.state.lastImage,\n          // preview: this.state.originalFile,\n        });\n        return;\n      }\n      this.setState({\n        showModal: !this.state.showModal,\n      });\n    }\n  };\n\n  render() {\n    console.log(showModal, this.state.preview);\n    let { originalFile, newFile, showModal } = this.state;\n\n    var componentConfig = {\n      iconFiletypes: [\".jpg\", \".png\"],\n      showFiletypeIcon: true,\n      postUrl: \"no-url\",\n    };\n    let djsConfig = {\n      autoProcesQueue: false,\n      maxFiles: 1,\n      acceptedFiles: \"image/*\",\n    };\n    var eventHandlers = {\n      init: this.initCallback,\n      addedfile: (file) => this.handleDroppedFile(file),\n    };\n\n    return (\n      <div className=\"row\">\n        {this.state.preview ? (\n          <div className=\"col-md-6 el-element-overlay\">\n            <div className=\"el-card-item\">\n              <div className=\"el-card-avatar el-overlay-1\">\n                <img\n                  src={this.state.preview}\n                  alt=\"no preview\"\n                  onError={(e) => {\n                    e.target.onerror = null;\n                    e.target.src = defaultUserImage;\n                  }}\n                />\n                <div className=\"el-overlay scrl-dwn\">\n                  <ul className=\"el-info\">\n                    <li>\n                      <button\n                        type=\"button\"\n                        className=\"btn-outline btn-danger btn-xs image-popup-vertical-fit p-2 p-l-10 p-r-10\"\n                        onClick={() => this.openModal()}\n                      >\n                        <i className=\"fa fa-edit statusIcon\"></i>\n                      </button>\n                    </li>\n                    <li>\n                      <button\n                        type=\"button\"\n                        className=\"btn-outline btn-danger btn-xs image-popup-vertical-fit p-2 p-l-10 p-r-10\"\n                        onClick={() => this.removePreview()}\n                      >\n                        <i className=\"fa fa-times statusIcon\"></i>\n                      </button>\n                    </li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n          </div>\n        ) : (\n          <div className=\"col-md-12\">\n            <DropzoneComponent\n              config={componentConfig}\n              eventHandlers={eventHandlers}\n              djsConfig={djsConfig}\n            />\n          </div>\n        )}\n        {showModal && (\n          <Modal toggleModal={this.toggleModal} modalfrom=\"dropZone\">\n            <div>\n              <div className=\"p-20\">\n                <MyCropper\n                  originalUploadFile={originalFile}\n                  handleCroppImage={this.handleCroppedImage}\n                  newFile={newFile}\n                />\n              </div>\n            </div>\n          </Modal>\n        )}\n      </div>\n    );\n  }\n}\nexport default Dropzone;\n"]},"metadata":{},"sourceType":"module"}